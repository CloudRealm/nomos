!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ng.common"),require("tslib"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("ionic.storage"),require("wako-app.mobile-sdk"),require("ng.core"),require("ionic.angular")):"function"==typeof define&&define.amd?define(["ng.common","tslib","ng.forms","ngx-translate.core","rxjs","ionic.storage","wako-app.mobile-sdk","ng.core","ionic.angular"],t):"object"==typeof exports?exports.plugin=t(require("ng.common"),require("tslib"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("ionic.storage"),require("wako-app.mobile-sdk"),require("ng.core"),require("ionic.angular")):e.plugin=t(e["ng.common"],e.tslib,e["ng.forms"],e["ngx-translate.core"],e.rxjs,e["ionic.storage"],e["wako-app.mobile-sdk"],e["ng.core"],e["ionic.angular"])}("undefined"!=typeof self?self:this,(function(e,t,n,r,i,o,s,u,c){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,(function(t){return e[t]}).bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({0:function(e,t,n){e.exports=n("zUnb")},"0S4P":function(t,n){t.exports=e},"17wl":function(e,n){e.exports=t},"3xDq":function(e,t){e.exports=n},TGDj:function(e,t){e.exports=r},Vgaj:function(e,t){e.exports=i},Zr0N:function(e,t){e.exports=o},doF0:function(e,t){e.exports=s},vOrQ:function(e,t){e.exports=u},z1lQ:function(e,t){e.exports=c},zUnb:function(e,t,n){"use strict";n.r(t),n.d(t,"PluginModule",(function(){return he}));var r=n("17wl"),i=n("0S4P"),o=n("z1lQ"),s=n("doF0"),u=n("TGDj");function c(e){return"function"==typeof e}var a=!1,l={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){a=e},get useDeprecatedSynchronousErrorHandling(){return a}};function p(e){setTimeout((function(){throw e}),0)}var f={closed:!0,next:function(e){},error:function(e){if(l.useDeprecatedSynchronousErrorHandling)throw e;p(e)},complete:function(){}},d=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function h(e){return null!==e&&"object"==typeof e}var g=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),b=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this._parentOrParents,r=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var o=0;o<n.length;++o)n[o].remove(this);if(c(r))try{r.call(this)}catch(a){t=a instanceof g?m(a.errors):[a]}if(d(i)){o=-1;for(var s=i.length;++o<s;){var u=i[o];if(h(u))try{u.unsubscribe()}catch(a){t=t||[],a instanceof g?t=t.concat(m(a.errors)):t.push(a)}}}if(t)throw new g(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function m(e){return e.reduce((function(e,t){return e.concat(t instanceof g?t.errors:t)}),[])}var y=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),v=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=f;break;case 1:if(!n){o.destination=f;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new _(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new _(o,n,r,i)}return o}return r.__extends(t,e),t.prototype[y]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(b),_=function(e){function t(t,n,r,i){var o,s=e.call(this)||this;s._parentSubscriber=t;var u=s;return c(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==f&&(c((u=Object.create(n)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=o,s._error=r,s._complete=i,s}return r.__extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;l.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=l.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):p(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;p(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};l.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),l.useDeprecatedSynchronousErrorHandling)throw n;p(n)}},t.prototype.__tryOrSetError=function(e,t,n){if(!l.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return l.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(p(r),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(v),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(v),x=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.__extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(v);function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var k=P(),w=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();var O=function(e){if(e&&"function"==typeof e[w])return o=e,function(e){var t=o[w]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((t=e)&&"number"==typeof t.length&&"function"!=typeof t)return i=e,function(e){for(var t=0,n=i.length;t<n&&!e.closed;t++)e.next(i[t]);e.complete()};var t;if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return r=e,function(e){return r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,p),e};if(e&&"function"==typeof e[k])return n=e,function(e){for(var t=n[k]();;){var r=t.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof t.return&&e.add((function(){t.return&&t.return()})),e};var n,r,i,o,s=h(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+s+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function E(e){return e}function C(e){return 0===e.length?E:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var j=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof v)return e;if(e[y])return e[y]()}return e||t||n?new v(e,t,n):new v(f)}(e,t,n);if(i.add(r?r.call(i,this.source):this.source||l.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),l.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){l.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e.destination;if(e.closed||e.isStopped)return!1;e=t&&t instanceof v?t:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=I(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(n){r(n),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[w]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:C(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=I(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function I(e){if(e||(e=l.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function A(e,t,n,r,i){if(void 0===i&&(i=new x(e,n,r)),!i.closed)return t instanceof j?t.subscribe(i):O(t)(i)}function T(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new M(e,t))}}var M=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new N(e,this.project,this.thisArg))},e}(),N=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.__extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)},t}(v);function U(e,t){return"function"==typeof t?function(n){return n.pipe(U((function(n,r){return(i=e(n,r),i instanceof j?i:new j(O(i))).pipe(T((function(e,i){return t(n,e,r,i)})));var i})))}:function(t){return t.lift(new D(e))}}var D=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new R(e,this.project))},e}(),R=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return r.__extends(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new x(this,t,n),o=this.destination;o.add(i),this.innerSubscription=A(this,e,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t}(S);function K(e){return function(t){var n=new q(e),r=t.lift(n);return n.caught=r}}var q=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new H(e,this.selector,this.caught))},e}(),H=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return r.__extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(o){return void e.prototype.error.call(this,o)}this._unsubscribeAndRecycle();var r=new x(this,void 0,void 0);this.add(r);var i=A(this,n,void 0,void 0,r);i!==r&&this.add(i)}},t}(S);function L(){}function F(e,t,n){return function(r){return r.lift(new V(e,t,n))}}var V=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new B(e,this.nextOrObserver,this.error,this.complete))},e}(),B=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o._tapNext=L,o._tapError=L,o._tapComplete=L,o._tapError=r||L,o._tapComplete=i||L,c(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||L,o._tapError=n.error||L,o._tapComplete=n.complete||L),o}return r.__extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(v),z=n("Zr0N"),Y=n("Vgaj");function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object(s.wakoLog)("plugin.nomos",e)}var Q=n("vOrQ"),W=function(){function e(e,t){this.toastCtrl=e,this.translateService=t}return e.prototype.simpleMessage=function(e,t,n,r){var i=this;void 0===n&&(n=2e3),void 0===r&&(r="top"),this.translateService.get(e,t).subscribe((function(e){i.toastCtrl.create({message:e,mode:"ios",position:r,duration:n}).then((function(e){e.present()}))}))},e.\u0275fac=function(t){return new(t||e)(Q["\u0275\u0275inject"](o.ToastController),Q["\u0275\u0275inject"](u.TranslateService))},e.\u0275prov=Q["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),$=function(){function e(e,t,n,r,i){this.toastService=e,this.storage=t,this.actionSheetController=n,this.modalCtrl=r,this.translateService=i}return e.prototype.patchStorageKey=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.storage.get("kodi-plugins-url")];case 1:return(e=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),e)]:[3,4];case 2:return r.sent(),[4,this.storage.remove("kodi-plugins-url")];case 3:r.sent(),r.label=4;case 4:return[4,this.storage.get("kodi-plugins-list")];case 5:return(t=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-list"),t)]:[3,8];case 6:return r.sent(),[4,this.storage.remove("kodi-plugins-list")];case 7:r.sent(),r.label=8;case 8:return[4,this.storage.get("openRemoteAfterClickOnPlay")];case 9:return(n=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),n)]:[3,12];case 10:return r.sent(),[4,this.storage.remove("openRemoteAfterClickOnPlay")];case 11:r.sent(),r.label=12;case 12:return[2]}}))}))},e.prototype.getStorageKeyPrefixed=function(e){return"nomos_"+e},e.prototype.getPluginUrl=function(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-url"))},e.prototype.setPluginUrl=function(e){return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),e)},e.prototype.getPlugins=function(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-list"))},e.prototype.setPlugins=function(e,t){var n=this;return void 0===t&&(t=!1),this.getPlugins().then((function(r){if(r&&t){var i=Object.keys(r).length===Object.keys(e).length;i&&Object.keys(r).forEach((function(t){var n=Object.assign({},r[t]),o=Object.assign({},e[t]);n.enabled=!0,o.enabled=!0,JSON.stringify(n)!==JSON.stringify(o)&&(i=!1)})),i?G("no changes in plugins"):n.toastService.simpleMessage("toasts.pluginsUpdated"),Object.keys(r).forEach((function(t){e.hasOwnProperty(t)&&(e[t].enabled=r[t].enabled)}))}return n.storage.set(n.getStorageKeyPrefixed("kodi-plugins-list"),e)}))},e.prototype.setPluginsFromUrl=function(e,t){var n=this;return void 0===t&&(t=!1),e=e.trim(),s.WakoHttpRequestService.request({url:e,method:"GET"},null,1e4,!0).pipe(U((function(r){return"string"==typeof r||0===Object.keys(r).length?Object(Y.of)(!1):(t||Object.keys(r).forEach((function(e){r[e].enabled=!0})),Object(Y.from)(n.setPlugins(r,t)).pipe(U((function(){return Object(Y.from)(n.setPluginUrl(e))})),T((function(){return!0}))))})),K((function(){return Object(Y.of)(!1)})))},e.prototype.refreshPlugins=function(){var e=this;s.WakoCacheService.get("CACHE_KEY_PLUGINS").subscribe((function(t){t?G("check plugins later"):(e.getPluginUrl().then((function(t){t&&e.setPluginsFromUrl(t,!0).subscribe()})),s.WakoCacheService.set("CACHE_KEY_PLUGINS",!0,"1d"))}))},e.prototype.getOpenRemoteAfterClickOnPlaySetting=function(){return this.storage.get(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay")).then((function(e){return!!e}))},e.prototype.setOpenRemoteAfterClickOnPlaySetting=function(e){return this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),e)},e.prototype.getPluginsByCategory=function(e){return Object(Y.from)(this.getPlugins()).pipe(T((function(t){if(!t)return null;var n={};return Object.keys(t).forEach((function(r){var i=t[r];i.enabled&&("movie"===e&&i.movieUrl||"episode"===e&&i.tvUrl)&&(n[r]=i)})),n})))},e.prototype.getInstalledPlugins=function(){return s.KodiGetAddonsForm.submit().pipe(K((function(){return Object(Y.of)({addons:[]})})),T((function(e){var t=[];return e.addons.forEach((function(e){t.push(e.addonid)})),t})))},e.prototype.open=function(e){var t=this,n={};s.KodiAppService.checkAndConnectToCurrentHost().pipe(K((function(e){return"hostUnreachable"===e?t.toastService.simpleMessage("toasts.kodi.hostUnreachable",{hostName:s.KodiAppService.currentHost.name},2e3):t.toastService.simpleMessage("toasts.kodi.noHost"),Y.NEVER})),U((function(){return G("CONNECTED"),t.getPluginsByCategory(e.category).pipe(F((function(e){n=e||{}})))})),U((function(){return t.getInstalledPlugins()})),T((function(e){G("_installedPlugins",e);var t=[];return Object.keys(n).forEach((function(r){e.includes(n[r].plugin)&&t.push(r)})),t}))).subscribe((function(r){if(G("supportedAndInstalledPlugins",r),0!==r.length)if(1!==r.length){var i=[];Object.keys(n).forEach((function(o){var s=n[o];r.includes(o)&&i.push({text:s.name,handler:function(){t.openOnPlugin(o,e)}})})),G("buttons",i),1!==i.length?t.actionSheetController.create({header:t.translateService.instant("actionSheets.kodi.openTitle"),buttons:i}).then((function(e){e.present()})):i[0].handler()}else t.openOnPlugin(r[0],e);else t.toastService.simpleMessage("toasts.kodi.noSupportedPluginsInstalled")}))},e.prototype.openViaPlaylist=function(e,t,n){return Object(Y.of)(!0).pipe(U((function(){return s.KodiApiService.doHttpAction("Playlist.Clear",{playlistid:0})})),U((function(){return s.KodiApiService.doHttpAction("Playlist.Insert",{playlistid:0,item:{file:e},position:0})})),U((function(){return s.KodiAppService.stopPlayingIfAny()})),U((function(){return s.KodiApiService.doHttpAction("Player.open",{item:{playlistid:0}})})),T((function(){return n&&s.EventService.emit(s.EventCategory.kodiRemote,s.EventName.open),t&&s.KodiAppService.openMedia$.next(t),s.EventService.emit(s.EventCategory.kodi,s.EventName.open),!0})))},e.prototype.openOnPlugin=function(e,t){var n=this;this.getPlugins().then((function(r){var i=r[e],o={hostName:s.KodiApiService.host.name,pluginName:i.name},u=n.getKodiPluginParams(i,t);return Object(Y.from)(n.getOpenRemoteAfterClickOnPlaySetting()).pipe(U((function(e){var r={movieTraktId:t.movie?t.movie.traktId:null,showTraktId:t.show?t.show.traktId:null,seasonNumber:t.episode?t.episode.traktSeasonNumber:null,episodeNumber:t.episode?t.episode.traktNumber:null},o="plugin://"+i.plugin+u;return G("Opening: "+o),n.openViaPlaylist(o,r,e)})),F((function(e){e?n.toastService.simpleMessage("toasts.kodi.open",o):n.toastService.simpleMessage("toasts.kodi.failedToOpen")}))).subscribe()}))},e.prototype.replacePlus=function(e){return e?e.replace(/\s/g,"+"):""},e.prototype.getKodiPluginParams=function(e,t){if(t.movie){var n=t.movie,r={tmdbId:n.tmdbId,rating:n.rating,date:n.released,title:n.title,tagline:n.tagline,plot:n.overview,original_title:n.originalTitle,imdb:n.imdbId,year:n.year,duration:60*n.runtime,mpaa:n.certification,genres:n.genres.join(" / "),fanart:n.images_url.backdrop_original,poster:n.images_url.poster_original,id:n.tmdbId,slug:"",trakt:n.traktId,showTmdbId:null,seasonNumber:null,episodeNumber:null,"title_+":this.replacePlus(n.title),tvdb:null,season:null,episode:null,"clearname_+":this.replacePlus(n.title),firstaired:n.released,"plot_+":this.replacePlus(n.overview),thumbnail:n.images_url.backdrop_original,now:Date.now().toString(),banner:n.images_url.backdrop_original,epimdb:null,eptmdb:null,eptrakt:null,epid:null,network_clean:"",clearname:n.title,epyear:null,tmdb:n.tmdbId,episodes:null,seasons:null,series_firstaired:null,seasons_no_specials:null,status:null,premiered:n.released};return this.getPluginParams(e.movieUrl,r)}var i=t.show,o=t.episode,s="2019-01-01";i.firstAired&&(s=i.firstAired);var u=new Date;return"string"==typeof o.firstAired&&(u=new Date(o.firstAired)),r={showTmdbId:i.tmdbId,seasonNumber:o.traktSeasonNumber,episodeNumber:o.traktNumber,"title_+":this.replacePlus(o.title),year:i.year,imdb:i.imdbId,tvdb:i.tvdbId,season:o.traktSeasonNumber,episode:o.traktNumber,"clearname_+":this.replacePlus(i.title),firstaired:s,duration:60*o.runtime,"plot_+":this.replacePlus(o.overview),thumbnail:i.images_url.backdrop_original,id:i.tvdbId,poster:i.images_url.poster_original,fanart:i.images_url.backdrop_original,now:Date.now().toString(),banner:i.images_url.backdrop_original,epimdb:o.imdbId,eptmdb:0,eptrakt:0,epid:o.tvdbId,genres:"",mpaa:i.certification,title:o.title,plot:o.overview,rating:o.rating,network_clean:"",clearname:i.title,epyear:u?u.getFullYear():null,slug:i.slug,tmdb:i.tmdbId,trakt:i.traktId,episodes:1,seasons:1,series_firstaired:s,seasons_no_specials:1,status:"Continuing",tmdbId:i.tmdbId,date:s,tagline:"",original_title:o.title,premiered:s},this.getPluginParams(e.tvUrl,r)},e.prototype.getPluginParams=function(e,t){return Object.keys(t).forEach((function(e){var n=Object(s.escapeText)(t[e]);e.match(/\+/g)||(t[e]=encodeURIComponent(n))})),Object(s.replacer)(e,t)},e.\u0275fac=function(t){return new(t||e)(Q["\u0275\u0275inject"](W),Q["\u0275\u0275inject"](z.Storage),Q["\u0275\u0275inject"](o.ActionSheetController),Q["\u0275\u0275inject"](o.ModalController),Q["\u0275\u0275inject"](u.TranslateService))},e.\u0275prov=Q["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),J=function(e){function t(t,n){var r=e.call(this)||this;return r.translate=t,r.kodiPluginService=n,r}return Object(r.__extends)(t,e),t.prototype.initialize=function(){var e=this;G("plugin initialized"),setTimeout((function(){e.kodiPluginService.refreshPlugins()}),1e4),this.kodiPluginService.patchStorageKey()},t.prototype.afterInstall=function(){G("plugin installed")},t.prototype.setTranslation=function(e,t){this.translate.setDefaultLang(e),this.translate.use(e),this.translate.setTranslation(e,t)},t.prototype.customAction=function(e,t){},t.\u0275fac=function(e){return new(e||t)(Q["\u0275\u0275inject"](u.TranslateService),Q["\u0275\u0275inject"]($))},t.\u0275prov=Q["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac}),t}(s.PluginBaseService);function Z(e,t){if(1&e){var n=Q["\u0275\u0275getCurrentView"]();Q["\u0275\u0275elementContainerStart"](0),Q["\u0275\u0275elementStart"](1,"ion-button",1),Q["\u0275\u0275listener"]("click",(function(){return Q["\u0275\u0275restoreView"](n),Q["\u0275\u0275nextContext"]().open()})),Q["\u0275\u0275element"](2,"ion-icon",2),Q["\u0275\u0275elementStart"](3,"ion-text",3),Q["\u0275\u0275text"](4),Q["\u0275\u0275pipe"](5,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementContainerEnd"]()}2&e&&(Q["\u0275\u0275advance"](4),Q["\u0275\u0275textInterpolate"](Q["\u0275\u0275pipeBind1"](5,1,"shared.buttonOpenKodi")))}function X(e,t){if(1&e){var n=Q["\u0275\u0275getCurrentView"]();Q["\u0275\u0275elementContainerStart"](0),Q["\u0275\u0275elementStart"](1,"div",4),Q["\u0275\u0275elementStart"](2,"ion-item-option",5),Q["\u0275\u0275listener"]("click",(function(){return Q["\u0275\u0275restoreView"](n),Q["\u0275\u0275nextContext"]().open()})),Q["\u0275\u0275elementStart"](3,"div",6),Q["\u0275\u0275element"](4,"ion-icon",7),Q["\u0275\u0275elementStart"](5,"ion-text"),Q["\u0275\u0275text"](6," Nomos "),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementContainerEnd"]()}}var ee=function(){function e(e){this.kodiPluginService=e,this.type="button"}return e.prototype.open=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this.kodiPluginService.open({category:this.movie?"movie":"episode",movie:this.movie,show:this.show,episode:this.episode}),[2]}))}))},e.\u0275fac=function(t){return new(t||e)(Q["\u0275\u0275directiveInject"]($))},e.\u0275cmp=Q["\u0275\u0275defineComponent"]({type:e,selectors:[["wk-open-button"]],inputs:{movie:"movie",show:"show",episode:"episode",type:"type"},decls:2,vars:2,consts:[[4,"ngIf"],["color","nomos","expand","block",1,"open-on-kodi",3,"click"],["name","play","color","light","slot","start"],["color","light"],[1,"ion-item-options"],["color","nomos",3,"click"],[1,"ion-item-detail"],["name","play"]],template:function(e,t){1&e&&(Q["\u0275\u0275template"](0,Z,6,3,"ng-container",0),Q["\u0275\u0275template"](1,X,7,0,"ng-container",0)),2&e&&(Q["\u0275\u0275property"]("ngIf","button"===t.type),Q["\u0275\u0275advance"](1),Q["\u0275\u0275property"]("ngIf","item-option"===t.type))},directives:[i.NgIf,o.IonButton,o.IonIcon,o.IonText,o.IonItemOption],pipes:[u.TranslatePipe],styles:[".ion-color-nomos[_ngcontent-%COMP%]{--ion-color-base:#4b1d52;--ion-color-base-rgb:53,66,82;--ion-color-contrast:#fff;--ion-color-contrast-rgb:255,255,255;--ion-color-shade:#483247;--ion-color-tint:#635260}ion-button[_ngcontent-%COMP%]{--ripple-color:var(--ion-color-nomos);--background-activated:var(--ion-color-nomos);--background-focused:var(--ion-color-nomos)}.ion-item-options[_ngcontent-%COMP%]{display:flex;height:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]{width:60px;display:grid;text-align:center}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2em;width:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{margin-top:3px;font-size:8px;text-transform:none}"]}),e}(),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.setMovie=function(e){this.movie=e},t.\u0275fac=function(e){return ne(e||t)},t.\u0275cmp=Q["\u0275\u0275defineComponent"]({type:t,selectors:[["app-movie-button"]],features:[Q["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[3,"movie"]],template:function(e,t){1&e&&Q["\u0275\u0275element"](0,"wk-open-button",0),2&e&&Q["\u0275\u0275property"]("movie",t.movie)},directives:[ee],styles:[""]}),t}(s.MovieDetailBaseComponent),ne=Q["\u0275\u0275getInheritedFactory"](te),re=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new ie(e,this.callback))},e}(),ie=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new b(n)),r}return r.__extends(t,e),t}(v),oe=n("3xDq");function se(e,t){1&e&&Q["\u0275\u0275element"](0,"ion-spinner")}function ue(e,t){if(1&e){var n=Q["\u0275\u0275getCurrentView"]();Q["\u0275\u0275elementStart"](0,"ion-item"),Q["\u0275\u0275elementStart"](1,"ion-label"),Q["\u0275\u0275text"](2),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementStart"](3,"ion-toggle",4),Q["\u0275\u0275listener"]("ionChange",(function(e){Q["\u0275\u0275restoreView"](n);var r=t.$implicit;return Q["\u0275\u0275nextContext"](2).toggleProvider(r.key,e.detail.checked)})),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;Q["\u0275\u0275advance"](2),Q["\u0275\u0275textInterpolate1"]("",r.name," "),Q["\u0275\u0275advance"](1),Q["\u0275\u0275property"]("ngModel",r.enabled)}}function ce(e,t){if(1&e&&(Q["\u0275\u0275elementStart"](0,"ion-list",0),Q["\u0275\u0275elementStart"](1,"ion-list-header"),Q["\u0275\u0275elementStart"](2,"ion-label"),Q["\u0275\u0275element"](3,"ion-icon",6),Q["\u0275\u0275text"](4),Q["\u0275\u0275pipe"](5,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275template"](6,ue,4,2,"ion-item",7),Q["\u0275\u0275elementEnd"]()),2&e){var n=Q["\u0275\u0275nextContext"]();Q["\u0275\u0275advance"](4),Q["\u0275\u0275textInterpolate1"](" ",Q["\u0275\u0275pipeBind1"](5,2,"pages.kodi-open-button.pluginList.header")," "),Q["\u0275\u0275advance"](2),Q["\u0275\u0275property"]("ngForOf",n.pluginArray)}}var ae=function(){function e(e,t,n,r){this.kodiPluginService=e,this.alertController=t,this.translateService=n,this.toastService=r,this.pluginArray=[],this.pluginsUrl=null,this.pluginsList=null,this.isLoading=!1}return e.prototype.ngOnInit=function(){var e=this;this.refresh(),this.kodiPluginService.getOpenRemoteAfterClickOnPlaySetting().then((function(t){e.openRemoteAfterClickOnPlay=t}))},e.prototype.refresh=function(){var e=this;this.kodiPluginService.getPluginUrl().then((function(t){e.pluginsUrl=t})),this.kodiPluginService.getPlugins().then((function(t){e.pluginsList=t,e.pluginArray=[],t&&Object.keys(t).forEach((function(n){var r=t[n];e.pluginArray.push({key:n,enabled:r.enabled,name:r.name})}))}))},e.prototype.setUrl=function(){var e=this;this.alertController.create({header:"URL",inputs:[{name:"url",type:"url",placeholder:"URL",value:this.pluginsUrl?this.pluginsUrl:""}],buttons:[{text:this.translateService.instant("alerts.cancelButton"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(t){var n;e.isLoading=!0,e.kodiPluginService.setPluginsFromUrl(t.url).pipe((n=function(){return e.isLoading=!1},function(e){return e.lift(new re(n))})).subscribe((function(t){t?(e.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlAdded"),e.refresh()):e.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlFailedToAdd")}))}}]}).then((function(e){e.present()}))},e.prototype.toggleProvider=function(e,t){this.pluginsList[e].enabled=t,this.kodiPluginService.setPlugins(this.pluginsList)},e.prototype.openRemoteAfterClickOnPlayChange=function(e){this.openRemoteAfterClickOnPlay=e,this.kodiPluginService.setOpenRemoteAfterClickOnPlaySetting(this.openRemoteAfterClickOnPlay)},e.\u0275fac=function(t){return new(t||e)(Q["\u0275\u0275directiveInject"]($),Q["\u0275\u0275directiveInject"](o.AlertController),Q["\u0275\u0275directiveInject"](u.TranslateService),Q["\u0275\u0275directiveInject"](W))},e.\u0275cmp=Q["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],decls:22,vars:18,consts:[["lines","full"],["name","cog","slot","start"],[4,"ngIf"],["button","",3,"click"],[3,"ngModel","ionChange"],["lines","full",4,"ngIf"],["name","list","slot","start"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(Q["\u0275\u0275elementStart"](0,"ion-list",0),Q["\u0275\u0275elementStart"](1,"ion-list-header"),Q["\u0275\u0275elementStart"](2,"ion-label"),Q["\u0275\u0275element"](3,"ion-icon",1),Q["\u0275\u0275text"](4),Q["\u0275\u0275pipe"](5,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275template"](6,se,1,0,"ion-spinner",2),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementStart"](7,"ion-item",3),Q["\u0275\u0275listener"]("click",(function(){return t.setUrl()})),Q["\u0275\u0275text"](8),Q["\u0275\u0275pipe"](9,"translate"),Q["\u0275\u0275pipe"](10,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementStart"](11,"ion-list",0),Q["\u0275\u0275elementStart"](12,"ion-list-header"),Q["\u0275\u0275elementStart"](13,"ion-label"),Q["\u0275\u0275text"](14),Q["\u0275\u0275pipe"](15,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementStart"](16,"ion-item"),Q["\u0275\u0275elementStart"](17,"ion-label"),Q["\u0275\u0275text"](18),Q["\u0275\u0275pipe"](19,"translate"),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementStart"](20,"ion-toggle",4),Q["\u0275\u0275listener"]("ionChange",(function(e){return t.openRemoteAfterClickOnPlayChange(e.detail.checked)})),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275elementEnd"](),Q["\u0275\u0275template"](21,ce,7,4,"ion-list",5)),2&e&&(Q["\u0275\u0275advance"](4),Q["\u0275\u0275textInterpolate1"](" ",Q["\u0275\u0275pipeBind1"](5,8,"pages.kodi-open-button.list.header")," "),Q["\u0275\u0275advance"](2),Q["\u0275\u0275property"]("ngIf",t.isLoading),Q["\u0275\u0275advance"](2),Q["\u0275\u0275textInterpolate2"](" ",Q["\u0275\u0275pipeBind1"](9,10,"pages.kodi-open-button.list.pluginsUrl")," ",t.pluginsUrl?t.pluginsUrl:Q["\u0275\u0275pipeBind1"](10,12,"pages.kodi-open-button.list.noUrl")," "),Q["\u0275\u0275advance"](6),Q["\u0275\u0275textInterpolate1"](" ",Q["\u0275\u0275pipeBind1"](15,14,"pages.kodi-open-button.openRemoteList.header")," "),Q["\u0275\u0275advance"](4),Q["\u0275\u0275textInterpolate1"](" ",Q["\u0275\u0275pipeBind1"](19,16,"pages.kodi-open-button.openRemoteList.item"),""),Q["\u0275\u0275advance"](2),Q["\u0275\u0275property"]("ngModel",t.openRemoteAfterClickOnPlay),Q["\u0275\u0275advance"](1),Q["\u0275\u0275property"]("ngIf",t.pluginsList))},directives:[o.IonList,o.IonListHeader,o.IonLabel,o.IonIcon,i.NgIf,o.IonItem,o.IonToggle,o.BooleanValueAccessor,oe.NgControlStatus,oe.NgModel,o.IonSpinner,i.NgForOf],pipes:[u.TranslatePipe],styles:[""]}),e}(),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.setShowEpisode=function(e,t){this.show=e,this.episode=t},t.\u0275fac=function(e){return pe(e||t)},t.\u0275cmp=Q["\u0275\u0275defineComponent"]({type:t,selectors:[["ng-component"]],features:[Q["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:2,consts:[[3,"show","episode"]],template:function(e,t){1&e&&Q["\u0275\u0275element"](0,"wk-open-button",0),2&e&&Q["\u0275\u0275property"]("show",t.show)("episode",t.episode)},directives:[ee],styles:[""]}),t}(s.EpisodeDetailBaseComponent),pe=Q["\u0275\u0275getInheritedFactory"](le),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.setShowEpisode=function(e,t){this.show=e,this.episode=t},t.\u0275fac=function(e){return de(e||t)},t.\u0275cmp=Q["\u0275\u0275defineComponent"]({type:t,selectors:[["ng-component"]],features:[Q["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:2,consts:[["type","item-option",3,"show","episode"]],template:function(e,t){1&e&&Q["\u0275\u0275element"](0,"wk-open-button",0),2&e&&Q["\u0275\u0275property"]("show",t.show)("episode",t.episode)},directives:[ee],styles:[""]}),t}(s.EpisodeDetailBaseComponent),de=Q["\u0275\u0275getInheritedFactory"](fe),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.pluginService=J,t.settingsComponent=ae,t.movieComponent=te,t.episodeComponent=le,t.episodeItemOptionComponent=fe,t.\u0275mod=Q["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=Q["\u0275\u0275defineInjector"]({factory:function(e){return ge(e||t)},providers:[J,$,W],imports:[[i.CommonModule,oe.FormsModule,o.IonicModule.forRoot(),u.TranslateModule.forRoot()]]}),t}(s.PluginBaseModule),ge=Q["\u0275\u0275getInheritedFactory"](he);t.default=he}})}));